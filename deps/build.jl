using Literate

repo_src = joinpath(@__DIR__,"..","src")
notebooks_dir = joinpath(@__DIR__,"..","notebooks")

files = [
  "Poisson equation"=>"t001_poisson.jl",
  "Code validation"=>"t002_validation.jl",
  "Linear elasticity"=>"t003_elasticity.jl", 
  "p-Laplacian"=>"t0041_p_laplacian.jl", 
  "Hyper-elasticity"=>"t004_hyperelasticity.jl",
  "DG discretization"=>"t005_dg_discretization.jl",
  "Poisson equation (with DG)"=> "t006_Stokes.jl",
  "Darcy equation (with RT)"=>"t007_darcy.jl",
  "Incompressible Navier-Stokes"=>"t008_inc_navier_stokes.jl"]

Sys.rm(notebooks_dir;recursive=true,force=true)
for (title,filename) in files
  Literate.notebook(joinpath(repo_src,filename), notebooks_dir; name=splitext(filename)[1], documenter=false, execute=false)
end

deps_jl = "deps.jl"

if isfile(deps_jl)
  rm(deps_jl)
end

open(deps_jl,"w") do f
  println(f, "# This file is automatically generated")
  println(f, "# Do not edit")
  println(f)
  println(f, :(const files = $files))
end
