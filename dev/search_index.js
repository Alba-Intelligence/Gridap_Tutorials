var documenterSearchIndex = {"docs":
[{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"EditURL = \"https://github.com/gridap/Tutorials/blob/master/src/t001_poisson.jl\"","category":"page"},{"location":"pages/t001_poisson/#Tutorial-1:-Poisson-equation-1","page":"1 Poisson equation","title":"Tutorial 1: Poisson equation","text":"","category":"section"},{"location":"pages/t001_poisson/#Problem-statement-1","page":"1 Poisson equation","title":"Problem statement","text":"","category":"section"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"We want to solve the Possion equation on the 3D domain depicted in the figure below with Dirichlet and Neumann boundary conditions. Dirichlet boundary conditions are applyed on Gamma_rm D, being the outer sides of the prism (marked in red). Non-homogeneous Neumann conditions are applyed to the internal boundaries Gamma_rm G, Gamma_rm Y, and Gamma_rm B (marked in green, yelow and blue respectively). And homogeneous Neumann boundary conditions are applyed in Gamma_rm W, the remaining portion of the boundary (marked in white).","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"(Image: model)","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"Formally, the problem to solve is: find u such that","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"\\begin{equation} \\left\\lbrace \\begin{aligned} -\\Delta u = f  \\ \\text{in} \\ \\Omega\\\nu = g \\ \\text{on}\\ \\Gamma{\\rm D}\\\n\\nabla u\\cdot n = h \\ \\text{on}\\  \\Gamma{\\rm N}\\\n\\end{aligned} \\right. \\end{equation}","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"being n the outwards unit normal vector to the Neumann boundary Gamma_rm N doteq Gamma_rm GcupGamma_rm YcupGamma_rm BcupGamma_rm W. For simplicity, we chose f(x) = 1, g(x) = 2, and h(x)=3 on Gamma_rm GcupGamma_rm YcupGamma_rm B and h(x)=0 on Gamma_rm W. The variable x is the position vector x=(x_1x_2x_3).","category":"page"},{"location":"pages/t001_poisson/#Numerical-scheme-1","page":"1 Poisson equation","title":"Numerical scheme","text":"","category":"section"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"In this first tutorial, we use a conventional Galerkin finite element (FE) method with conforming Lagrangian finite element spaces. In that case, the model problem reduces to the weak equation: find uin U_g such that $ a(v,u) = b(v) $ for all vin V_0, where U_g and V_0 are the subset of functions in H^1(Omega) that fulfill the Dirichlet boundary condition g and 0 respectively. The bilinear and linear forms for this problems are $ a(v,u) \\doteq \\int{\\Omega} \\nabla v \\cdot \\nabla u \\ {\\rm d}\\Omega, \\quad b(v) \\doteq \\int{\\Omega} v\\ f  \\ {\\rm  d}\\Omega + \\int{\\Gamma{\\rm N}} v\\ g \\ {\\rm d}\\Gamma_{\\rm N} $","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"While solving this problem in Gridap, we are going to build the main objects that are involved in this equation in a very inuitive way.","category":"page"},{"location":"pages/t001_poisson/#Implementation-1","page":"1 Poisson equation","title":"Implementation","text":"","category":"section"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"The step number 0, is to load the Gridap project. If you have followed the steps of the README.md file, it is simply done like this:","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"using Gridap","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"As in any FE simulation, we need a discretization of the computational domain, which, in addition, is aware of the different boundaries to impose boundary conditions. This information is provided in Gridap by objects inheriting from the abstract type DiscreteModel. In the following line, we build an instance of DiscreteModel by loading a model from a json file.","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"model = DiscreteModelFromFile(\"../models/model.json\");","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"You can easily inspect the generated model in Paraview by writting it to vtk format.","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"Previous line generates four different files model_0.vtu, model_1.vtu, model_2.vtu, and model_3.vtu containing the vertices, edges, faces, and cells present in the discrete model. Moreover, you can easily inspect, which boundaries are defined within the model.","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"For instance, if we want to see which faces of the model are on the boundary Gamma_rm B (i.e., the walls of the circular hole), open the file model_2.vtu and chose coloring by the element field \"circle\". You should see that only the faces on the circular hole hava a value different from 0.","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"(Image: )","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"On the other hand, to see which vertices are on the Dirichlet boundary Gamma_rm D, open the file model_0.vtu and chose coloring by the field \"sides\".","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"(Image: )","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"You can easily see, by inspecting the files in paraview, that the walls of the triangular hole Gamma_rm G and the walls of the square hole Gamma_rm Y are identified in the model with the names \"triangle\" and \"square\" respectively.","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"order = 1\ndiritag = \"sides\"\nfespace = ConformingFESpace(Float64,model,order,diritag);\n\ng(x) = 2.0\nV = TestFESpace(fespace)\nU = TrialFESpace(fespace,g);\n\ntrian = Triangulation(model)\nquad = CellQuadrature(trian,order=2);\n\nneumanntags = [\"circle\", \"triangle\", \"square\"]\nbtrian = BoundaryTriangulation(model,neumanntags)\nbquad = CellQuadrature(btrian,order=2);\n\nf(x) = 1.0\na(v,u) = inner( ∇(v), ∇(u) )\nb_Ω(v) = inner(v, f)\nt_Ω = AffineFETerm(a,b_Ω,trian,quad);\n\nh(x) = 3.0\nb_Γ(v) = inner(v, h)\nt_Γ = FESource(b_Γ,btrian,bquad);\n\nassem = SparseMatrixAssembler(V,U);\n\nop = LinearFEOperator(V,U,assem,t_Ω,t_Γ);\n\nls = LUSolver()\nsolver = LinearFESolver(ls);\n\nuh = solve(solver,op);\n\nwritevtk(trian,\"results\",cellfields=[\"uh\"=>uh]);","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"(Image: )","category":"page"},{"location":"pages/t001_poisson/#","page":"1 Poisson equation","title":"1 Poisson equation","text":"This page was generated using Literate.jl.","category":"page"},{"location":"#Gridap-tutorials-1","page":"Home","title":"Gridap tutorials","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Hands on tutorials of the Gridap project","category":"page"},{"location":"#","page":"Home","title":"Home","text":"","category":"page"}]
}
